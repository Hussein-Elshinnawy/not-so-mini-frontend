<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Product Details</title>
    <style>
      /* Add your CSS styles here */
      .product-container {
        max-width: 800px;
        margin: auto;
        padding: 20px;
      }
      .product-image {
        width: 100%;
      }
      .product-gallery img {
        width: 100px;
        margin: 5px;
        cursor: pointer;
      }
      .product-gallery img:hover {
        opacity: 0.8;
      }
    </style>
  </head>
  <body>
    <div class="product-container">
      <h1 id="productName">Product Name</h1>
      <img id="productImage" src="" alt="Main Product" class="product-image" />
      <div class="product-gallery" id="productGallery">
        <!-- Additional images will be inserted here -->
      </div>
      <p id="productDescription">Product Description</p>
      <p>Price: <span id="productPrice">$0.00</span></p>
      <p>Number in Stock: <span id="productStock">0</span></p>
      <p>Rating: <span id="productRating">0</span>/5</p>
      <div class="quantity-controls">
        <button onclick="decrementQuantity()">-</button>
        <span id="productQuantity">1</span>
        <button onclick="incrementQuantity()">+</button>
      </div>
      <button onclick="addToCart()">Add to Cart</button>
    </div>

    <script>
      // let quantity = 1;
      // let productId;
      // function incrementQuantity() {
      //   if (quantity < 10) {
      //     quantity++;
      //     document.getElementById("productQuantity").textContent = quantity;
      //   }
      // }
      // function decrementQuantity() {
      //   if (quantity > 1) {
      //     quantity--;
      //     document.getElementById("productQuantity").textContent = quantity;
      //   }
      // }
      // document.addEventListener("DOMContentLoaded", function () {
      //   const queryString = window.location.search;
      //   const urlParams = new URLSearchParams(queryString);
      //   const productId = urlParams.get("productID");
      //   fetchProductDetails(productId);
      // });
      // function fetchProductDetails(productId) {
      //   fetch(`http://localhost:3000/api/v1/product/${productId}`)
      //     .then((response) => response.json())
      //     .then((product) => {
      //       document.getElementById("productName").textContent = product.name;
      //       document.getElementById("productDescription").textContent =
      //         product.description;
      //       document.getElementById(
      //         "productPrice"
      //       ).textContent = `$${product.price}`;
      //       console.log("product id" + product.id);
      //       tempproductId = product.id;
      //       document.getElementById("productImage").src = product.image;
      //       document.getElementById("productStock").textContent = product.stock;
      //       document.getElementById("productRating").textContent =
      //         product.rating;
      //       product.images.forEach((image) => {
      //         const imgElement = document.createElement("img");
      //         imgElement.src = image;
      //         imgElement.alt = product.name;
      //         document.getElementById("productGallery").appendChild(imgElement);
      //       });
      //     })
      //     .catch((error) => {
      //       console.error("Error fetching product details:", error);
      //     });
      // }
      // function addToCart() {
      //   const quantity = document.getElementById("productQuantity").textContent;

      //   // Create orderItem object
      //   const orderItem = {
      //     id: productId, // Use the productId from the higher scope
      //     quantity: quantity,
      //   };

      //   // Store orderItem in sessionStorage
      //   sessionStorage.setItem("orderItem", JSON.stringify(orderItem));

      //   // Navigate to cart.html
      //   window.location.href = "cart.html";
      // }

      let quantity = 1;
      let productId;
      function incrementQuantity() {
        if (quantity < 10) {
          quantity++;
          document.getElementById("productQuantity").textContent = quantity;
        }
      }
      function decrementQuantity() {
        if (quantity > 1) {
          quantity--;
          document.getElementById("productQuantity").textContent = quantity;
        }
      }
      document.addEventListener("DOMContentLoaded", function () {
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        productId = urlParams.get("productID"); // Assign value to productId here
        fetchProductDetails(productId);
      });

      function fetchProductDetails(productId) {
        fetch(`http://localhost:3000/api/v1/product/${productId}`)
          .then((response) => response.json())
          .then((product) => {
            document.getElementById("productName").textContent = product.name;
            document.getElementById("productDescription").textContent =
              product.description;
            document.getElementById(
              "productPrice"
            ).textContent = `$${product.price}`;
            console.log("product id: " + product.id);
            document.getElementById("productImage").src = product.image;
            document.getElementById("productStock").textContent = product.stock;
            document.getElementById("productRating").textContent =
              product.rating;
            product.images.forEach((image) => {
              const imgElement = document.createElement("img");
              imgElement.src = image;
              imgElement.alt = product.name;
              document.getElementById("productGallery").appendChild(imgElement);
            });
          })
          .catch((error) => {
            console.error("Error fetching product details:", error);
          });
      }
      function addToCart() {
        const quantity = document.getElementById("productQuantity").textContent;

        const orderItem = {
          id: productId,
          quantity: quantity,
        };

        // Retrieve the existing cart array or initialize a new one
        let cart = JSON.parse(sessionStorage.getItem("cart")) || [];

        // Add the new orderItem to the cart array
        cart.push(orderItem);

        // Store the updated cart array in sessionStorage
        sessionStorage.setItem("cart", JSON.stringify(cart));

        // Navigate to cart.html
        window.location.href = "cart.html";
      }

      // function addToCart() {
      //   const quantity = document.getElementById("productQuantity").textContent;

      //   const orderItem = {
      //     id: productId,
      //     quantity: quantity,
      //   };

      //   console.log("Storing orderItem:", orderItem); // Debugging line

      //   sessionStorage.setItem("orderItem", JSON.stringify(orderItem));

      //   console.log(
      //     "Retrieved orderItem:",
      //     JSON.parse(sessionStorage.getItem("orderItem"))
      //   );

      //   window.location.href = "cart.html";
      // }
    </script>
  </body>
</html>
